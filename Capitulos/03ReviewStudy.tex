%---------------------------------------------------------------------
%
%                          Capítulo 3
%
%---------------------------------------------------------------------

\chapter{Estudio Previo}
\label{cap:previo}

\begin{FraseCelebre}
\begin{Frase}
El hombre no se mide por lo que conoce, \\
sino en cómo aplica lo que conoce
\end{Frase}
\begin{Fuente}
Anónimo
\end{Fuente}
\end{FraseCelebre}

\begin{resumen}
En este capítulo encontramos, en primer lugar, una revisión de la plataforma cNGD, base de la placa de expansión. Seguidamente, se expone una primera aproximación de las necesidades y requisitos de la \textit{shield}, en cuanto a dispositivos y funcionalidades se refiere, así como una revisión de los sensores y actuadores a incluir.
\end{resumen}

%-------------------------------------------------------------------
\section{cNGD: Cognitive Next Generation Device}
%-------------------------------------------------------------------
\label{previo:sec:cngd}
%-------------------------------------------------------------------

Comenzamos el trabajo describiendo brevemente el \ac{CNGD}, plataforma para \ac{CWSN}, puesto que será sobre esta donde se acoplará nuestra \textit{shield}, lo que hace indispensable conocer sus características. La figura \ref{previo:fig:cngd} muestra detalladamente este nodo.

\begin{figure}[!h]
\centering 
\subfloat[Vista superior.]{\includegraphics[width=\textwidth]{Imagenes/Bitmap/Capitulo3/cngdtop}}  
\qquad
\subfloat[Vista inferior.]{\includegraphics[width=0.8\textwidth]{Imagenes/Bitmap/Capitulo3/cngdbottom}}     
\caption[Vista detallada del cNGD.]{Vista detallada del cNGD, obtenidas de \cite{aguspfc}.}
\label{previo:fig:cngd}
\end{figure}

El \ac{CNGD} incluye un \ac{MCU} PIC32MX675F256L, fabricado por Microchip \cite{pic32datasheet}, cuyas características técnicas se resumen a continuación.

\begin{multicols}{2}
\begin{itemize}
\item \ac{MCU} de 32 bits.
\item Memoria Flash de 256 KB.
\item Memoria \ac{RAM} de 64KB.
\item Velocidad máxima de funcionamiento de 80 MHz.
\item Módulos para comunicación serie \ac{UART}, \ac{SPI} e \ac{I2C}.
\item Conectividad por medio de \ac{USB} 2.0 \ac{OTG} y 10/100 Ethernet MAC.
\item Interfaz para programación y depuración.
\item Temporizadores digitales, \ac{ADC} y \ac{GPIO}.
\item Modos de bajo consumo.
\item Encapsulado de 100 pines.
\end{itemize}
\end{multicols}

En cuanto a las Interfaces de comunicación Radio, \ac{RI}, se incluyen tres transceptores, con acceso a tres bandas del espectro: 434 MHz, 868 MHz y 2.4 GHz, todas ellas pertenecientes a bandas sin licencia, denominadas \ac{ISM}. Esto es relevante, puesto que, al ser bandas de acceso libre, pueden estar ocupadas por otras aplicaciones. El \ac{CNGD}, por medio de su capacidad cognitiva, es capaz de sensar el espectro en estas bandas y decidir dinámicamente cuál usar en función de la ocupación y del ruido en los canales. La comunicación se realiza bajo el protocolo MiWi \cite{miwi}, estándar inalámbrico propiedad de Microchip.

Las dos primeras (434 y 868 MHz) fueron diseñadas para esta plataforma a partir del integrado MRF49XA \cite{mrf49xa}, soportando tasas binarias de hasta 115.2 Kbps. Para la comunicación en 2.4 GHz, se emplea el MRF24J40MA \cite{mrf24j40}, el cual nos permite elevar la velocidad de transmisión hasta los 250 Kbps.

\medskip

Una de las principales ventajas de este diseño es la cabecera de expansión, también denominada \textit{header}, la cual permite ampliar el diseño de forma modular. Será en la misma donde insertaremos nuestra placa, por lo que le hacemos un estudio más exhaustivo. Se compone de 40 pines, en los que se permite el acceso a los periféricos del microcontrolador. En la tabla \ref{previo:tab:headerspinout} encontramos una relación entre el pin del \textit{header}, el pin del microcontrolador y las funciones que puede realizar, pudiendo estar varias de estas funciones multiplexadas en el mismo pin.

\begin{center}
{\footnotesize
\begin{longtable}{l l l l l l l}

% aquí añadimos el encabezado de la primera hoja.
\hline
PIN & MCU PIN & 1a Func. & 2a Func. & 3a Func. & 4a Func. & 5a Func. \\
\hline \hline
\endfirsthead

% aquí añadimos el encabezado del resto de hojas.
\hline
PIN & MCU PIN & 1a Func. & 2a Func. & 3a Func. & 4a Func. & 5a Func. \\
\hline \hline
\endhead

% aquí añadimos el fondo de todas las hojas, excepto de la última.
\multicolumn{5}{c}{Continúa en la siguiente página.}
\endfoot

% aquí añadimos el fondo de la última hoja.
\endlastfoot

% aquí añadimos el cuerpo de la tabla.
00 & 19 & INT2 & RE9 & - & - & - \\ \hline
01 & 20 & VBUSON & AN5 & C1IN+ & CN7 & RB5\\ \hline
02 & 22 & AN3 & CN4 & RB3 & - & -\\ \hline
03 & 35 & AN11 & ERXERR & RB11 & - & - \\ \hline
04 & 41 & AN12 & ERXD0 & RB12 & - & - \\ \hline
05 & 42 & AN13 & ERXD1 & RB13 & - & - \\ \hline
06 & 51 & USBID & RF3 & - & - & - \\ \hline
07 & 54 & VBUS & - & - & - & - \\ \hline
08 & 13 & nMCLR & - & - & - & - \\ \hline
09 & 68 & EMDIO & IC1 & RD8 & - & - \\ \hline
10 & 59 & SDA2 & RA3 & - & - & - \\ \hline
11 & 58 & SCL2 & RA2 & - & - & - \\ \hline
12 & 57 & D+ & RG2 & - & - & - \\ \hline
13 & 56 & D- & RG3 & - & - & - \\ \hline
14 & - & VCC & - & - & - & - \\ \hline
15 & - & GND & - & - & - & - \\ \hline
16 & 44 & AN15 & CN12 & RB15 & - & -\\ \hline
17 & 43 & AN14 & RB14 & - & - & - \\ \hline
18 & 28 & VREF- & CVREF- & RA9 & - & - \\ \hline
19 & 29 & VREF+ & CVREF+ & RA10 & - & - \\ \hline
20 & 14 & REFCLK & U3nCTS & U6RX & CN11 & RG9 \\ \hline
21 & 11 & SDA4 & SDI2 & U3RX & CN9 & RG7 \\ \hline
22 & 5 & RE7 & - & - & - & -\\ \hline
23 & 3 & RE5 & - & - & - & -\\ \hline
24 & - & VCC & - & - & - & -\\ \hline
25 & 88 & ETXD0 & RF1 & - & - & -\\ \hline
26 & 87 & ETXD1 & RF0 & - & - & -\\ \hline
27 & 71 & EMDC & IC4 & RD11 & -& - \\ \hline
28 & - & VCC & - & - & - & -\\ \hline
29 & - & BAT+ & - & - & - & -\\ \hline
30 & - & BAT- & - & - & - & - \\ \hline
31 & - & GND & - & - & - & -\\ \hline
32 & 69 & IC2 & RD9 & - & - & - \\ \hline
33 & 83 & ETXEN & CN15 & RD6 & - & -\\ \hline
34 & - & GND & - & - & - & - \\ \hline
35 & 4 & RE6 & - & - & - & - \\ \hline
36 & 6 & RC1 & - & - & - & - \\ \hline
37 & 10 & SCK2 & U6TX & U3nRTS &CN8 & RG6\\ \hline
38 & 12 & ECRSDV & SCL4 & SDO2 & U3TX & CN10/RG8 \\ \hline
39 & 21 & AN4 & C1IN- & CN6 & RB4 & - \\ \hline
\\ % esta línea es importante para que deje un espacio entre la tabla y el nombre de la tabla.
\caption[Descripción del uso de los pines del \textit{header} del cNGD.]{Descripción del uso de los pines, obtenido de \cite{aguspfc}.}
\label{previo:tab:headerspinout}
\end{longtable}}
\end{center}

Resaltamos las más relevantes para nuestro diseño:

\begin{itemize}

\item \emph{Fuentes de alimentación}. Para la alimentación de los componentes, son necesarios estos pines.

	\begin{itemize}
	\item VCC. Conectado al sistema de alimentación del \ac{CNGD}, accesible desde los pines 14, 24 y 28.
	\item GND. Conectado a la masa del \ac{CNGD}, accesible desde los pines 15, 31 y 34.
	\end{itemize}

\item \emph{\ac{SPI}}. Para la conexión serie de dispositivos por medio de este estándar. Las tres señales que necesita, SDI, SDO y SCK son accesibles desde los pines 21, 38 y 37, respectivamente.

\item \emph{\ac{I2C}}. Para la conexión serie de dispositivos por medio de este estándar. Encontramos disponibles dos canales del microcontrolador:

	\begin{itemize}
	\item \ac{I2C} 2. SCL en el pin 38 y SDA en el pin 21.
	\item \ac{I2C} 4. SCL en el pin 11 y SDA en el pin 10.
	\end{itemize}

\item \emph{\ac{ADC}}. Son accesibles desde los pines 9 de los 16 \ac{ADC} del microcontrolador, referenciados en la tabla \ref{previo:tab:headerspinout} con el prefijo ANx. Adicionalmente, los pines VREF+ y VREF-, situados en el 19 y 18, proporcionan funciones auxiliares a este periférico.

\item \emph{\ac{CN}}. Se genera una interrupción en el sistema cuando se produce un cambio en la señal de entrada. Un total de 9 \ac{CN} son accesibles desde los pines del \textit{header}.

\item \emph{\ac{GPIO}}. Representan casi todos los pines del \textit{header}, multiplexados en su mayoría con otra función. Son identificados en la tabla \ref{previo:tab:headerspinout} mediante el uso del prefijo Rxx.

\end{itemize}

Finalmente, el \ac{CNGD} es programado por medio del módulo de programación PGE. Esta misma interfaz es usada para la depuración del sistema. Esto será útil para comprobar la ejecución correcta del código desarrollado, por lo que se ampliará en el capítulo \ref{cap:software}.

%-------------------------------------------------------------------
\section{Sensores}
%-------------------------------------------------------------------
\label{previo:sec:sensores}
%-------------------------------------------------------------------

A continuación comenzamos el estudio de los sensores, con objeto de determinar cuáles incluir en la placa de expansión. Estos van a ser la entrada de información ambiental a nuestro sistema, ya que por medio de sus mediciones conoceremos los parámetros del entorno. Dada su relevancia debemos escogerlos adecuadamente, por lo que definimos el procedimiento que detallamos a continuación:

\begin{enumerate}

\item \emph{Definir los requisitos y valorarlos}. En esta fase seleccionamos los parámetros más destacables que nuestro sensor debe cumplir, y un margen de tolerancia para los mismos. Además, como restricción adicional, tendremos que cumplir los requisitos impuestos por la plataforma, tales como la tensión de alimentación, comunicación por medio de puertos disponibles, entre otros.
\item \emph{Buscar sensores comerciales}. Tomando como base los resultados de la fase anterior, y usando las páginas web de los principales proveedores (como Farnell \cite{farnell}, RS \cite{rs}, Digikey \cite{digikey} o SparkFun \cite{sparkfun}), realizaremos la búsqueda.
\item \emph{Estudiar las hojas de características}. Estas son proporcionadas por los fabricantes y en ellas se detallan todas las propiedades que definen su producto. De esta evaluación obtenemos la verificación de que cumplen las características definidas.

\end{enumerate}

Como requisitos genéricos de nuestro sistema, y que por tanto deberán ser motivo de evaluación, definimos:

\begin{itemize}

\item \emph{Consumo}. No debemos olvidar que el sistema, al estar alimentado con baterías, requiere un estricto control sobre el gasto energético, así como permitir estados de bajo consumo. Este requisito fue considerado a la hora del diseño del \ac{CNGD}, permitiendo la desconexión o la suspensión de los dispositivos que no se encuentran en uso, y por tanto será también objeto de evaluación.\newline Se buscará, de entre toda la gama de sensores, aquellos cuyas especificaciones de consumo sean menores, o bien que puedan ser sometidos a estados de bajo consumo.
\item \emph{Precio}. Al igual que en el caso anterior, el bajo precio es uno de los pilares fundamentales para el diseño. Esto es muy comprensible, puesto que a la hora de fabricar lotes de unidades una pequeña diferencia en coste puede llevar a grandes ahorros económicos.\newline Tendremos que encontrar una solución de compromiso entre especificaciones del sensor y el coste.
\item \emph{Salida}. La podemos clasificar en dos tipos: 
	\begin{itemize}
	\item Analógica, en el cual algún parámetro eléctrico, tal como la tensión, corriente o resistencia, es dependiente de la magnitud a medir y requiere, por tanto, del empleo de un \ac{ADC} para su tratamiento en el microcontrolador.
	\item Digital, en el cual la medición se representa por una palabra binaria, y que se conecta al microcontrolador, generalmente, por buses serie, como pueden ser \ac{SPI} o \ac{I2C}, o entradas genéricas (\ac{GPIO}).
	\end{itemize}
No imponemos ningún filtro a priori, puesto que el \ac{CNGD} dispone de entradas tanto digitales como analógicas.

\end{itemize}

En el mercado podemos encontrar muchos tipos de sensores, en función del parámetro que se desee medir, por lo que centraremos nuestra búsqueda en base a la aplicación. Como nuestro propósito es el de crear una placa con un propósito genérico dentro de un \ac{AMI}, escogeremos los sensores ambientales que puedan ser utilizados en un número alto de aplicaciones. Se presentan en los siguientes puntos.

%-------------------------------------------------------------------
\subsection{Temperatura}
%-------------------------------------------------------------------
\label{previo:sec:temperatura}
%-------------------------------------------------------------------
Un sensor de temperatura se basa en la dependencia con la temperatura de alguno de los materiales que lo forman, y ofrecen este dato como resultado. Según \cite{iele}, los sensores de temperatura se pueden clasificar en:

\begin{itemize}
\item \emph{Metálicos resistivos}, en los que la dependencia con la temperatura viene relacionada por la presencia de un elemento metálico, como puede ser el platino, el cobre o el níquel; y la variación de la temperatura se transforma en una variación en su resistencia eléctrica.
\item \emph{Resistivos semiconductores}, conocidos como termistores, presentan en su seno materiales semiconductores. Encontramos dos subtipos, el \ac{NTC}, formados a partir de óxidos de materiales pesados; y el \ac{PTC}, que incluye materiales como el $BaTiO_3$ o el $SrTiO_3$.
\item \emph{Semiconductores activos}, basados en la relación de la tensión base-emisor de un transistor con la temperatura.
\item \emph{Termopares}, basados en efectos termoeléctricos, como pueden ser el de Seebeck, el de Peltier y el de Thompson.
\end{itemize}

Un sensor que nos permita conocer la temperatura es muy habitual encontrarlo en \ac{WSN}, ya que es un parámetro que es útil en muchas de las aplicaciones potenciales del sistema, ya sea conocer la temperatura de una estancia, con el objeto de actuar sobre ella, si nos encontramos en un entorno doméstico o de trabajo; o de conocer la temperatura del suelo, con el objeto de monitorizar su variación con el tiempo, si es usado en temas de investigación medioambiental.

Los principales parámetros que los definen son:

\begin{itemize}

\item \emph{Rango de medida}. Define las temperaturas máximas y mínimas en las que se puede medir. \newline
En nuestra aplicación, puede ser tan amplio como se pueda, pero fijando como mínimo un rango de medida entre -20 ºC y 100 ºC.
\item \emph{Precisión}. Es una forma de expresar la calidad de la medida, entendiendo ésta como la fiabilidad entre el dato medido y el dato real. En ocasiones también aparece nombrado como \emph{error}. Como es comprensible, es un parámetro que varía mucho el precio del mismo.\newline
Puesto que lo usaremos en una aplicación genérica, debemos encontrar un compromiso entre precio y precisión, por lo que centraremos nuestra búsqueda en valores de entre $\pm$0.2 ºC y $\pm$2 ºC.
\end{itemize}

Los sensores de temperatura comerciales suelen ser, en su mayoría, termistores, a los que se les añade un circuito de acondicionamiento, de forma que en la salida únicamente encontramos variaciones en tensión o, directamente, una secuencia de bits. Los que han sido evaluados, siguiendo estos requisitos, aparecen resumidos en la Tabla \ref{previo:tab:temp}.

\begin{savenotes}
\begin{table}[h]
\centering
\scalebox{0.9}{
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
Fabricante & Modelo & Rango de Medida & Precisión\footnote{Típica en el margen que incluye a 25 ºC.} & Consumo\footnote{Típico durante el modo de funcionamiento} & Precio & Sal.\footnote{Salida. ``An.'' denota salida analógica, y ``Dig.'' salida digital.} & Ref. \\ \hline \hline
Analog Devices & TMP36 & [-40 ºC, 125 ºC] & $\pm$1 ºC & 50 $\mu$A & 1.61 \euro & An. & \cite{tmp36} \\ \hline
Microchip & MCP9701A & [-40 ºC, 125 ºC] & $\pm$2 ºC & 6 $\mu$A & 0.24 \euro & An. & \cite{mcp9701} \\ \hline
Texas Instr. & LM20B & [-55 ºC, 130 ºC] & $\pm$2 ºC & 10 $\mu$A & 1.07 \euro & An. & \cite{lm20} \\ \hline
Texas Instr. & TMP101 & [-55 ºC, 125 ºC] & $\pm$2 ºC & 45 $\mu$A & 2.56 \euro & Dig. & \cite{tmp101} \\ \hline
Analog Devices & AD7814 & [-55 ºC, 125 ºC] & $\pm$2 ºC & 250 $\mu$A & 2.71 \euro & Dig. & \cite{ad7814} \\ \hline
Microchip & MCP9800 & [-55 ºC, 125 ºC] & $\pm$0.5 ºC & 200 $\mu$A & 0.98 \euro & Dig. & \cite{mcp9800} \\ \hline
\end{tabular}
}
\caption{Comparación de sensores de temperatura comerciales.
\label{previo:tab:temp}}
\end{table}
\end{savenotes}

Como comentario final, resaltar que una característica adicional de los modelos con salida digital es la disposición de modos de bajo consumo.

%-------------------------------------------------------------------
\subsection{Acelerómetro}
%-------------------------------------------------------------------
\label{previo:sec:acelerometro}
%-------------------------------------------------------------------
Definimos un acelerómetro como un sensor que nos permite medir las aceleraciones que sufre el elemento sobre el cual se inserta. Podemos encontrar varios tipos, a saber:

\begin{itemize}
\item \emph{Mecánico}. Basado en la Segunda Ley de Newton, se fabrica mediante la unión de la masa de prueba a un dinamómetro cuyo eje se encuentra en la dirección en la que se quiere medir.
\item \emph{Piezoeléctrico}. Tiene su fundamento físico en el hecho que, cuando se comprime un cristal con propiedades piezoeléctricas, se crea una carga eléctrica que es directamente proporcional a la fuerza que se aplica, la cual a su vez es proporcional a la aceleración.
\item \emph{Tecnología \ac{MEMS}}. Están basados en el traspaso por convección de calor, cuya variación es causada por la aceleración.
\end{itemize}

A priori, puede parecer que introducir un sensor de este tipo es extraño para la obtención de parámetros de un entorno. No obstante, el uso de este tipo de sensores está creciendo en multitud de aplicaciones, por la versatilidad que le caracteriza. Tanto es así que puede ser usado, por ejemplo, para detectar la posición de la placa en el plano tridimensional, o para detectar vibraciones, bien generadas por la acción humana (como pisadas en el suelo, vehículos pasando por un puente o la apertura de una puerta) o por la naturaleza (como los terremotos).

Las principales características que los definen se resumen a continuación:

\begin{itemize}
\item \emph{Fondo de escala}. Es la máxima aceleración que se puede detectar. Se define como una proporción de la aceleración provocada por la gravedad terrestre, de forma que un valor de 2g implica una medida máxima de aceleración de 2 veces la de la gravedad.\newline Como consecuencia de estar desarrollando una placa para una aplicación genérica, pondremos como requisito que sea capaz de detectar, al menos, una aceleración de 8g.
\item \emph{Sensibilidad}. Se define como el impacto que genera una variación de la variable de entrada a la salida, de forma que un valor alto de sensibilidad implica que una leve variación de la entrada ocasione una gran variación a la salida.\newline En los acelerómetros, este parámetro es dual al fondo de escala, de forma que cuanto más bajo sea el fondo de escala más alta será la sensibilidad.
\item \emph{Ejes de medida}. Número de ejes en los que se podrán detectar las variaciones en la aceleración. Estos se corresponden con los ejes de coordenadas: $\hat{x}$, $\hat{y}$ y $\hat{z}$.\newline En este aspecto, no admitiremos considerar acelerómetros que no midan en los tres ejes, ya que entendemos que no podemos dejar de considerar ninguno.
\end{itemize}

En la actualidad, los acelerómetros comerciales para propósitos generales están basados en tecnología \ac{MEMS}, construidos e integrados en un chip de silicio, y que permiten fabricar acelerómetros de tres ejes. La tabla \ref{previo:tab:acc} muestra los acelerómetros comerciales que han sido estudiados.

\begin{savenotes}
\begin{table}[h]
\centering
\scalebox{1}{
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
Fabricante & Modelo & Fondo de escala & Ejes & Consumo\footnote{Típico en estado de medición contínuo.} & Precio & Ref. \\ \hline \hline
Freescale & MMA8453Q & 2g, 4g, 8g & $\hat{x}$, $\hat{y}$, $\hat{z}$ & 23 $\mu$A & 1.05 \euro & \cite{mma8453q} \\ \hline
Analog Devices & ADXL345 & 2g, 4g, 8g, 16g & $\hat{x}$, $\hat{y}$, $\hat{z}$ & 14 $\mu$A & 5.09 \euro & \cite{adxl345} \\ \hline
ST & LIS3DH & 2g, 4g, 8g, 16g & $\hat{x}$, $\hat{y}$, $\hat{z}$ & 11 $\mu$A & 3.72 \euro & \cite{lis3dh} \\ \hline
\end{tabular}
}
\caption{Comparación de acelerómetros comerciales.
\label{previo:tab:acc}}
\end{table}
\end{savenotes}

No aparece información acerca de la salida en dicha tabla puesto que todos los modelos estudiados tienen salida digital. Asimismo, todos disponen de modos de bajo consumo.


%-------------------------------------------------------------------
\subsection{Presencia}
%-------------------------------------------------------------------
\label{previo:sec:presencia}
%-------------------------------------------------------------------
Un sensor de presencia nos permite determinar el movimiento de personas bajo el área geográfica que cubre. Estos se denominan sensores \ac{PIR}, debido a que se basan en el efecto de que la persona emite radiación infrarroja por consecuencia de tener una temperatura distinta del cero absoluto. El sensor es capaz de determinar la presencia por comparación entre la radiaciones recibidas, de forma que se activa si detecta un cambio.

Este tipo de sensores son muy comunes en \ac{AMI} en los que es necesario el control de personas. Así, este sensor puede emplearse en aplicaciones de seguridad (si se detecta presencia en momentos en los que no se debería detectar puede generarse una alarma), eficiencia energética (regulando parámetros ambientales como la temperatura o la luminosidad en función de la ocupación del espacio), entre otros.

Las características más destacables que podemos encontrar en un sensor de presencia serían:

\begin{itemize}
\item \emph{Lente de Fresnel}. Es la responsable de concentrar las radiaciones en el foco del sensor, para que puedan ser detectadas. Este parámetro es muy importante, puesto que un \ac{PIR} sin este tipo de lente únicamente detectaría presencia en una zona muy limitada del espacio.\newline Como consecuencia, para nuestro diseño exigiremos la existencia de esta lente, bien sea integrada en el propio sensor o añadida a parte.
\item \emph{Área cubierta}. Guarda relación directa con la lente de Fresnel, como hemos visto, siendo ésta la que determine la máxima distancia a la que se podrá detectar la presencia.\newline En el contexto de una aplicación genérica, pondremos como requisito una distancia de detección mínima de 3 metros.
\end{itemize}

La tabla \ref{previo:tab:pir} muestra los sensores de presencia bajo estudio, en los que han sido evaluadas todas las características enunciadas anteriormente.

\begin{savenotes}
\begin{table}[h]
\centering
\scalebox{1}{
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
Fabricante & Modelo & Lente & Distancia & Consumo\footnote{Típico en detección.} & Precio\footnote{Incluye el precio por sensor y lente, en caso de que la última sea externa.} & Ref. \\ \hline \hline
Murata & E710ST0 & Externa & [3 m, 6 m] & N/D & 5.61 \euro & \cite{e710st0} \\ \hline
Panasonic & EKMC160 & Integrada & 5 m & 100 $\mu$A & 15.49 \euro & \cite{ekmc} \\ \hline
Panasonic & AMN33112J & Integrada & 3 m & 270 $\mu$A & 11.91 \euro & \cite{amn} \\ \hline
\end{tabular}
}
\caption{Comparación de sensores de presencia comerciales.
\label{previo:tab:pir}}
\end{table}
\end{savenotes}

La salida de todos los modelos estudiados es digital, de forma que obtenemos un nivel alto de tensión en caso de detectar presencia, y un nivel bajo en caso contrario.


%-------------------------------------------------------------------
\subsection{Luminosidad}
%-------------------------------------------------------------------
\label{previo:sec:luminosidad}
%-------------------------------------------------------------------
Un sensor de luminosidad es aquel que permite determinar la cantidad de luz que se encuentra en el espacio de medida del mismo. Podemos encontrar principalmente dos tipos: las fotorresistencias, conocidas por sus siglas inglesas \ac{LDR}, las cuales son unas resistencias cuyo valor depende de la luz, y los fotodiodos, que ofrecen a la salida una corriente que es proporcional al nivel de iluminación que encuentren. Serán estos últimos sobre los que centraremos nuestra búsqueda.

La elección de este sensor viene motivada por las múltiples aplicaciones que puede desempeñar en el contexto de los \ac{AMI}, como puede ser la de eficiencia energética, regulando la luz artificial en función de la luz solar, o la de confort, adaptando los niveles de luminosidad en función de nuestra preferencia o de la situación en la que nos encontramos.

Un sensor de luminosidad se define principalmente en base a los siguientes parámetros:

\begin{itemize}
\item \emph{Pico de longitud de onda}. Determina la longitud de onda del fotón cuya respuesta mejor se percibe. A partir de ésta, se dibuja la curva de respuesta del sensor frente a otras longitudes.\newline Impondremos que esta curva de respuesta sea lo más similar posible a la del ojo humano, puesto que esto hará que el sensor responda con la misma información que recibe una persona.
\item \emph{Corriente de oscuridad}. Parámetro que determina la corriente que ofrece a la salida en condiciones de iluminación nula. Supone un \textit{offset} a la medida.\newline Al ser un dato parásito, exigiremos que sea tan pequeño como sea posible.
\item \emph{Salida}. Todos ellos ofrecen una salida analógica en corriente, al estar buscando fotodiodos. No obstante, algunos modelos presentan algún circuito que modifica su curva de salida, pasando de ser lineal con la luminosidad a hacerlo de forma logarítmica.
\end{itemize}

En la tabla \ref{previo:tab:lum} se encuentran los sensores de luminosidad bajo estudio, donde se evalúan todas las características enunciadas anteriormente. En la misma, el consumo coincide con las corrientes en condiciones de iluminación (a 100 luxes) y oscuridad, como consecuencia de ser un sensor analógico en corriente. 

\begin{savenotes}
\begin{table}[h]
\centering
\scalebox{0.9}{
\begin{tabular}{|c|c|c|c|c|c|c|c|}
\hline
Fabricante & Modelo & Pico en $\lambda$ & Oscuridad & Iluminación\footnote{Típico bajo 100 luxes.} & Salida & Precio & Ref. \\ \hline \hline
Everlight & ALS PT19 & 630 $\mu$m & 100 nA & 15 $\mu$A & Lineal & 0.76 \euro\footnote{De venta en SparkFun.} & \cite{alspt19} \\ \hline
Avago & APDS 9005 & 500 $\mu$m & 300 nA & 40 $\mu$A & Lineal & 0.74 \euro & \cite{apds9005} \\ \hline
Osram & SFH5711 & 550 $\mu$m & <10 nA & 20 $\mu$A & Logarítmica & 2.27 \euro & \cite{sfh5711} \\ \hline
\end{tabular}
}
\caption{Comparación de sensores de luminosidad comerciales.
\label{previo:tab:lum}}
\end{table}
\end{savenotes}

%-------------------------------------------------------------------
\section{Actuadores}
%-------------------------------------------------------------------
\label{previo:sec:actuadores}
%--------------------------------------------------------------------
Los actuadores constituyen la forma de modificación del entorno como consecuencia de la medición realizada por parte de los sensores y de la inteligencia del sistema. Estos pueden ejercer la función de actuar directamente, como podría ser el caso de un relé, o bien de hacer de nexo entre el sistema y el controlador responsable de la actuación, como puede ser emular un mando a distancia.

En esta placa, dado su propósito general, se tenderá hacia la fabricación de este segundo tipo, de forma que se buscarán actuadores que se caractericen por su versatilidad y su generalidad, aunque teniendo siempre presente la funcionalidad. No se presentan tablas comparativas, como se ha realizado con los sensores, porque los modelos comerciales de los actuadores bajo estudio poseen características muy similares.

Los actuadores que desarrollan esta función los encontramos resumidos a continuación.

%-------------------------------------------------------------------
\subsection{Emisor Infrarrojo}
%-------------------------------------------------------------------
\label{previo:sec:ir}
%-------------------------------------------------------------------
Un emisor \ac{IR} no es más que un \ac{LED} cuyo espectro de emisión de luz se centra en estas longitudes de ondas, típicamente en el entorno de los 950 nm. Esta señal es modulada para la transmisión digital de comandos, propios para cada dispositivo.

La inserción de este actuador en la placa está más que justificada, ya que son incontables los dispositivos que pueden controlarse hoy en día mediante un mando a distancia por \ac{IR}, como pueden ser la televisión, equipos de música, la climatización o las persianas, entre otros.

Las características que deberá reunir este actuador serán las de potencia media de transmisión, para que su uso no se vea limitado en exceso con la distancia, y un tiempo de respuesta que permita la modulación de las señales a transmitir.

%-------------------------------------------------------------------
\subsection{Buzzer}
%-------------------------------------------------------------------
\label{previo:sec:buzzer}
%-------------------------------------------------------------------
Un buzzer es un dispositivo que, mediante la vibración de un elemento piezoeléctrico, produce una onda acústica a unas determinadas frecuencias, las cuales dependen de la forma de excitación del dispositivo y del propio material.

El propósito de este actuador no es otro que el de avisar a los usuarios acerca de las condiciones ambientales, generalmente cuando suponen la existencia de un peligro potencial, para que sean éstos los que, en último término, lleven a cabo la actuación.

Como consecuencia de este hecho, se exigirá que el buzzer emita, al menos, a 70 dB(A), para asegurar un nivel suficiente de volumen que permita su audición.

%-------------------------------------------------------------------
\subsection{Salidas digitales}
%-------------------------------------------------------------------
\label{previo:sec:gpio}
%-------------------------------------------------------------------

Estas salidas son muy útiles, puesto que, a partir de ellas, es posible controlar cualquier dispositivo externo cuya señal de control sea digital. En el microcontrolador, estas salidas se corresponden con los puertos \ac{GPIO}, a varios de los cuales da nuestra plataforma acceso en sus \textit{header}s, como vimos en la sección \ref{previo:sec:cngd}.


%-------------------------------------------------------------------
%\section*{\NotasBibliograficas}
%-------------------------------------------------------------------
%\TocNotasBibliograficas
%Citamos algo para que aparezca en la bibliografía\ldots
%\citep{ldesc2e}

%\medskip

%Y también ponemos el acrónimo \ac{CVS} para que no cruja.

%Ten en cuenta que si no quieres acrónimos (o no quieres que te falle la compilación en ``release'' mientras no tengas ninguno) basta con que no definas la constante \verb+\acronimosEnRelease+ (en \texttt{config.tex}).


%-------------------------------------------------------------------
%\section*{\ProximoCapitulo}
%-------------------------------------------------------------------
%\TocProximoCapitulo

%...

% Variable local para emacs, para  que encuentre el fichero maestro de
% compilación y funcionen mejor algunas teclas rápidas de AucTeX
%%%
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "../Tesis.tex"
%%% End:
